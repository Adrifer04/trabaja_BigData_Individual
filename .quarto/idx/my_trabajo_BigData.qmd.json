{"title":"La primera de España","markdown":{"yaml":{"title":"La primera de España","description":"Viendo como la selección española logró este trofeo\n","author":[{"name":"Adrian Fernández","affiliation":"Universitat de València","affiliation-url":"https://www.uv.es"}],"date":"2026-01-07","categories":["trabajo BigData","Futbol","España"],"image":"./imagenes/escudo.png","title-block-banner":true,"title-block-banner-color":"#FFFFFF","toc-depth":3,"smooth-scroll":true,"format":{"html":{"backgroundcolor":"#DCDCDC","link-external-newwindow":true}},"code-tools":true,"code-link":true},"headingText":"Intro","containsRefs":false,"markdown":"\n\n\n\nPara realizar el trabajo, hemos sacado los datos de la pagina webb Kaggle, una web la cual contiene millones de datos, y entre ellos, de la Champions League. Os dejamos por aqui el [enlace](https://www.kaggle.com/){target=\"_blank\"}\n\n---\n\n## 1. Lugar\n\nEl mundial se jugó en Sudáfrica. Fue la primera vez que se hacía en África y se utilizaron 10 estadios diferentes. He creado este mapa interactivo para situar las ciudades y los estadios donde se jugaron los partidos.\n\n```{r}\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(maps)\nlibrary(plotly)\n\n\nruta_a_datos_1 <- \"./datos/FIFA_World_Cup_1558_23.csv\"\ndf_completo <- read_csv(ruta_a_datos_1)\n\naño_2010 <- df_completo %>%\n  rename(Año = Year, Ciudad = City, Estadio = Stadium) %>% \n  select(Año, Estadio, Ciudad) %>% \n  filter(Año == 2010) %>%\n  group_by(Ciudad, Estadio) %>% \n  mutate(Ciudad = case_when( \n    Ciudad ==\"Mangaung/Bloemfontein\" ~ \"Bloemfontein\",\n    Ciudad == \"Nelson Mandela Bay/Port Elizabeth\" ~ \"Port Elizabeth\",\n    Ciudad == \"Polokwane\" ~ \"Pietersburg\", \n    Ciudad == \"Tshwane/Pretoria\" ~ \"Pretoria\", \n    Ciudad == \"Phokeng\" ~ \"Rustenburg\",\n    TRUE ~ Ciudad)) %>% \n  slice(1) %>%\n  ungroup()\n\n\ndata(world.cities)\ncoords_sudafrica <- world.cities %>%\n  filter(country.etc == \"South Africa\") %>%\n  select(name, lat, long)\n\nmapa_finales <- año_2010 %>% \n  left_join(coords_sudafrica, by = c(\"Ciudad\" = \"name\")) \n\n\nmap_plot <- plot_geo(data = mapa_finales,\n                     lat = ~lat,   \n                     lon = ~long) %>% \n  \n  add_markers(\n    text = ~paste(\"<b>Ciudad:</b>\", Ciudad, \"<br>\",\n                  \"<b>Estadio:</b>\", Estadio),\n    color = I(\"#D32F2F\"), \n    size = I(12),   \n    marker = list(\n      line = list(color = \"white\", width = 0.5),\n    hoverinfo = \"text\")) %>%\n  \n  layout(\n    title = \"Sedes Mundial Sudáfrica 2010\",\n    geo = list(\n      scope = 'africa',   \n      showframe = FALSE,\n      showland = TRUE,\n      landcolor = \"#F0F0F0\",\n      showocean = TRUE,\n      oceancolor = \"#B3E5FC\",\n      countrycolor = \"white\",\n      lonaxis = list(range = c(16, 33)), \n      lataxis = list(range = c(-35, -22))\n    )\n  ) %>%\n  config(displayModeBar = FALSE)\n\n\nmap_plot\n```\n---\n\n## 2. Resultados\n\nAquí analizo la trayectoria de la selección. Jugamos 7 partidos en total. Aunque empezamos perdiendo contra Suiza (el punto rojo del gráfico), luego encadenamos 6 victorias seguidas hasta la final. En el gráfico se ve el rival, la fase y el resultado de cada encuentro.\n\n\n```{r}\nlibrary(tidyverse)\n\nruta_a_datos_1 <- \"./datos/resultados.csv\"\ndf_completo <- read_csv(ruta_a_datos_1) \n\nPartidos_España <- df_completo %>% \n  mutate(date = as.Date(date)) %>% \n  filter(tournament == \"FIFA World Cup\",\n         between(date, as.Date(\"2010-06-11\"), as.Date(\"2010-07-11\"))) %>% \n  filter(home_team == \"Spain\" | away_team == \"Spain\") %>%\n  \n  mutate(Resultado_ESP = case_when(\n    (home_team == \"Spain\" & home_score < away_score) ~ \"Perdido\",\n    (away_team == \"Spain\" & away_score < home_score) ~ \"Perdido\",\n    (home_team == \"Spain\" & home_score > away_score) ~ \"Ganado\",\n    (away_team == \"Spain\" & away_score > home_score) ~ \"Ganado\" ))%>% \n  \n  unite(col = \"Resultado\", \n        home_score, away_score, \n        sep = \" - \", \n        remove = FALSE) %>% \n \n  rename(Local = home_team, Visitante = away_team,\n         Torneo = tournament) %>% \n  select(Local, Visitante, Resultado, Resultado_ESP)\n\n\nPartidos_España <- Partidos_España %>%\n  mutate(Orden = 1:n(),\n         Fase = c(\"Grupos 1\", \"Grupos 2\", \"Grupos 3\", \n                  \"Octavos\", \"Cuartos\", \"Semis\", \"Final\"),\n         Rival = ifelse(Local == \"Spain\", Visitante, Local))\n\n\n  ggplot(Partidos_España, aes(x = Orden, y = Resultado_ESP, group = 1)) +\n  geom_path(color = \"gray80\", size = 1) +\n  geom_point(aes(color = Resultado_ESP), size = 12) + \n  geom_text(aes(label = Resultado), color = \"white\", fontface = \"bold\", size = 3) +\n  geom_text(aes(label = paste(\"vs\", Rival)), vjust = -2.5, size = 3.5, fontface =      \"italic\") +\n  geom_text(aes(label = Fase), vjust = 3.5, size = 3, color = \"gray30\") +\n  scale_color_manual(values = c(\"Ganado\" = \"#228B22\", \"Perdido\" = \"#CC0000\")) +\n  scale_y_discrete(limits = c(\"Perdido\", \"Ganado\")) +\n  theme_minimal() +\n  labs(title = \"Cronología: El camino a la estrella\",\n       subtitle = \"Resultados oficiales de cada encuentro\",\n       x = NULL, y = NULL) +\n  theme(\n    panel.grid = element_blank(),\n    axis.text = element_blank(),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 14))\n```\n---\n\n## 3. Goles\n\nVamos a ver las estadísticas de goles. Lo curioso de este mundial es que España ganó metiendo pocos goles, pero encajando muy pocos también.\n\n### 3.1 Goles metidos\n\nEn ataque, la cosa estuvo muy repartida entre pocos jugadores. He sacado el top 3 de goleadores de la selección: Villa metió la mayoría, pero los goles decisivos de Puyol (semis) e Iniesta (final) aparecen también destacados.\n\n```{r}\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(maps)\nlibrary(plotly)\nlibrary(ggimage)\nlibrary(cropcircles) #install.packages(\"cropcircles\")\nlibrary(magick)    \n\nruta_a_datos_1 <- \"./datos/goalscorers.csv\"\ndf_completo <- read_csv(ruta_a_datos_1)\n\nmundial <- df_completo %>% \nrename(Fecha = date, Equipo_Local = home_team, Equipo_Visitante = away_team\n       , Goleador = scorer) %>% \n  select(Fecha, Equipo_Local, Equipo_Visitante, Goleador) %>% \n  mutate(Fecha = as.Date(Fecha)) %>% \n  filter(between(Fecha, as.Date(\"2010-06-11\") , as.Date(\"2010-07-11\"))) %>% \n  filter(Equipo_Local == \"Spain\"| Equipo_Visitante == \"Spain\") %>% \n  count(Goleador) %>% \n  arrange(desc(n)) %>% \n  head(3)\n\nimagenes_goleadores <- data.frame(\n  Goleador = c(\"David Villa\", \"Andrés Iniesta\", \"Carles Puyol\"),\n  Foto = c(\"villa.jpg\", \"iniesta.png\", \"puyol.jpg\")) %>% \n\n  mutate(logo = file.path(\"imagenes\", Foto))\n\ntop_3 <- left_join(mundial,imagenes_goleadores, by = \"Goleador\") \n\ntop_3 <- top_3 %>%\n  mutate(logo_circular = circle_crop(logo))\n\nmi_grafico <- ggplot(top_3, aes(x = reorder(Goleador, n), y = n)) +\n  geom_col(fill = \"#DD0000\", width = 0.6) +\n  coord_flip() +\n  geom_image(aes(image = logo_circular, y = 0), size = 0.3) +\n  \n  geom_text(aes(label = n), hjust = -0.2, fontface = \"bold\", size = 3.5) +\n  \n  scale_y_continuous(expand = expansion(mult = c(0.2, 0.1))) + \n  \n  labs(\n    title = \"Goleadores de la selección\",\n    subtitle = \"Mundial Sudáfrica 2010\",\n    x = NULL, \n    y = \"Goles\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.y = element_blank(),\n    axis.text.x = element_blank(),\n    axis.ticks = element_blank(),\n    panel.grid.major.y = element_blank(),\n    panel.grid = element_blank(),\n    plot.margin = margin(10, 20, 10, 20))\n\nmi_grafico\n```\n\n### 3.2 Goles encajados\n\nAquí es donde se ganó el mundial. He comparado el promedio de goles encajados por partido de las selecciones que llegaron lejos. Como se ve en el gráfico, la defensa de España fue la mejor, encajando poquísimos goles en comparación con los partidos jugados\n\n\n```{r}\nlibrary(tidyverse)\nlibrary(ggimage)\nlibrary(countrycode)\n\n\nruta_a_datos_1 <- \"./datos/FIFA - 2010.csv\"\ndf_completo <- read_csv(ruta_a_datos_1)\n\n\ntop_10_grafico <- df_completo %>% \n  rename(equipo = Team, \n         partidos_jugados = `Games Played`, \n         goles_contra = `Goals Against`) %>% \n  mutate(equipo = case_when( equipo == \"England\" ~ \"United Kingdom\",\n                            TRUE ~ equipo)) %>%\n  mutate(Goles_partido = goles_contra / partidos_jugados) %>% \n  select(equipo, partidos_jugados, Goles_partido) %>% \n  filter(partidos_jugados >= 4) %>% \n  arrange(Goles_partido) %>% \n  mutate(iso2 = countrycode(equipo, origin = \"country.name\",\n                            destination = \"iso2c\")) %>% \n  mutate(iso2 = tolower(iso2)) %>% \n  mutate(flag_URL = paste0(\"https://hatscripts.github.io/circle-flags/flags/\", iso2, \".svg\"))\n\n\nmi_grafico <- ggplot(top_10_grafico, aes(x = partidos_jugados, y = Goles_partido)) +\n  theme_minimal() +\n  \n  geom_image(aes(image = flag_URL), size = 0.08, position = position_jitter\n             (width = 0.2, height = 0.02, seed = 123)) + \n  \n  \n  labs(\n    title = \"Las mejores defensas\",\n    x = \"Partidos Jugados\",\n    y = \"Goles encajados\") +\n  scale_x_continuous(breaks = 4:7,                \n                     limits = c(3.5, 7.5),         \n                     expand = c(0, 0)) +\n  scale_y_continuous(expand = expansion(mult = c(0.1, 0.1))) +\n  \n  theme(\n    plot.title = element_text(face = \"bold\", size = 16),\n    panel.grid = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.margin = margin(10, 20, 10, 20))\n\n\nmi_grafico\n```\n---\n\n## 4. El gran momento\n\nPara el momento más importante del trabajo he querido hacer algo distinto.He cogido una secuencia de fotos del gol de Iniesta y las he unido todas para crear un GIF. Un gol que sin duda marcó la historia de España.\n\n```{r}\nlibrary(magick)\n\nimg1  <- image_read(\"./imagenes/1.png\") %>% image_scale(\"700\")\nimg2  <- image_read(\"./imagenes/2.png\") %>% image_scale(\"700\")\nimg3  <- image_read(\"./imagenes/3.png\") %>% image_scale(\"700\")\nimg4  <- image_read(\"./imagenes/4.png\") %>% image_scale(\"700\")\nimg5  <- image_read(\"./imagenes/5.png\") %>% image_scale(\"700\")\nimg6  <- image_read(\"./imagenes/6.png\") %>% image_scale(\"700\")\nimg7  <- image_read(\"./imagenes/7.png\") %>% image_scale(\"700\")\nimg8  <- image_read(\"./imagenes/8.png\") %>% image_scale(\"700\")\nimg9  <- image_read(\"./imagenes/9.png\") %>% image_scale(\"700\")\nimg10 <- image_read(\"./imagenes/10.png\") %>% image_scale(\"700\")\nimg11 <- image_read(\"./imagenes/11.png\") %>% image_scale(\"700\")\nimg12 <- image_read(\"./imagenes/12.png\") %>% image_scale(\"700\")\nimg13 <- image_read(\"./imagenes/13.png\") %>% image_scale(\"700\")\nimg14 <- image_read(\"./imagenes/14.png\") %>% image_scale(\"700\")\nimg15 <- image_read(\"./imagenes/15.png\") %>% image_scale(\"700\")\n\nequipos_unidos <- image_join(img1, img2, img3, img4, img5, img6, img7, img8, \n                             img9, img10, img11, img12, img13, img14, img15)\n\nimage_animate(image_scale(equipos_unidos), fps = 1)\n```\n\n---\n\n## 5. Palmarés\n\nFinalmente, así quedó la tabla histórica de campeones del mundo después de nuestra victoria en 2010. He utilizado una tabla un poco más visual con las banderas y los trofeos que tenía cada país hasta ese año.\n\n```{r}\nlibrary(tidyverse)\nlibrary(gt)\nlibrary(gtExtras)   \nlibrary(countrycode) \n\n\nruta_a_datos_1 <- \"./datos/WorldCups.csv\"\ndf_completo <- read_csv(ruta_a_datos_1)\ntabla_preparada <- df_completo %>%\n  filter(Year <= 2010) %>% \n  rename(ganador = Winner) %>%\n  mutate(ganador = case_when( \n    ganador == \"Germany FR\" ~ \"Germany\",\n    ganador == \"England\" ~ \"United Kingdom\",\n    TRUE ~ ganador)) %>% \n  group_by(ganador) %>% \n  summarise(n = n()) %>% \n  arrange(desc(n)) %>% \n  \n  \n  mutate(iso2 = countrycode(ganador, origin = \"country.name\",\n                            destination = \"iso2c\")) %>%\n  mutate(iso2 = tolower(iso2)) %>%\n  mutate(bandera_url = paste0(\"https://hatscripts.github.io/circle-flags/flags/\", iso2, \".svg\")) %>%\n  select(bandera_url, ganador, n)\n\n\n\nmi_tabla_final <- tabla_preparada %>%\n  gt() %>%\n  gt_img_rows(columns = bandera_url, height = 30) %>%\n  cols_label(\n    bandera_url = \"\",\n    ganador = \"Selección\",\n    n = \"Títulos\") %>%\n  tab_header(\n    title = md(\"**Palmarés**\"),\n    subtitle = \"Mundiales ganados hasta 2010\")%>%\n  cols_align(align = \"center\", columns = n) %>%\n  gt_theme_dark() %>%\n  tab_style(\n    style = list(cell_text(weight = \"bold\", color = \"#FFD700\", size = pct(100))),\n    locations = cells_body(columns = n))\n\n\nmi_tabla_final\n```\n\n---\n\n<br>\n\nCon esto acabo mi trabajo para BigData!!\n\n<br>\n\n----------------------\n\n<br>\n\n### Información sobre la sesión\n\nAbajo muestro mi entorno de trabajo y paquetes utilizados\n\n```{r}\n#| echo: false\nsessioninfo::session_info() %>% \n  details::details(summary = 'current session info') \n```\n\n\n\n","srcMarkdownNoYaml":"\n\n\n## Intro \n\nPara realizar el trabajo, hemos sacado los datos de la pagina webb Kaggle, una web la cual contiene millones de datos, y entre ellos, de la Champions League. Os dejamos por aqui el [enlace](https://www.kaggle.com/){target=\"_blank\"}\n\n---\n\n## 1. Lugar\n\nEl mundial se jugó en Sudáfrica. Fue la primera vez que se hacía en África y se utilizaron 10 estadios diferentes. He creado este mapa interactivo para situar las ciudades y los estadios donde se jugaron los partidos.\n\n```{r}\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(maps)\nlibrary(plotly)\n\n\nruta_a_datos_1 <- \"./datos/FIFA_World_Cup_1558_23.csv\"\ndf_completo <- read_csv(ruta_a_datos_1)\n\naño_2010 <- df_completo %>%\n  rename(Año = Year, Ciudad = City, Estadio = Stadium) %>% \n  select(Año, Estadio, Ciudad) %>% \n  filter(Año == 2010) %>%\n  group_by(Ciudad, Estadio) %>% \n  mutate(Ciudad = case_when( \n    Ciudad ==\"Mangaung/Bloemfontein\" ~ \"Bloemfontein\",\n    Ciudad == \"Nelson Mandela Bay/Port Elizabeth\" ~ \"Port Elizabeth\",\n    Ciudad == \"Polokwane\" ~ \"Pietersburg\", \n    Ciudad == \"Tshwane/Pretoria\" ~ \"Pretoria\", \n    Ciudad == \"Phokeng\" ~ \"Rustenburg\",\n    TRUE ~ Ciudad)) %>% \n  slice(1) %>%\n  ungroup()\n\n\ndata(world.cities)\ncoords_sudafrica <- world.cities %>%\n  filter(country.etc == \"South Africa\") %>%\n  select(name, lat, long)\n\nmapa_finales <- año_2010 %>% \n  left_join(coords_sudafrica, by = c(\"Ciudad\" = \"name\")) \n\n\nmap_plot <- plot_geo(data = mapa_finales,\n                     lat = ~lat,   \n                     lon = ~long) %>% \n  \n  add_markers(\n    text = ~paste(\"<b>Ciudad:</b>\", Ciudad, \"<br>\",\n                  \"<b>Estadio:</b>\", Estadio),\n    color = I(\"#D32F2F\"), \n    size = I(12),   \n    marker = list(\n      line = list(color = \"white\", width = 0.5),\n    hoverinfo = \"text\")) %>%\n  \n  layout(\n    title = \"Sedes Mundial Sudáfrica 2010\",\n    geo = list(\n      scope = 'africa',   \n      showframe = FALSE,\n      showland = TRUE,\n      landcolor = \"#F0F0F0\",\n      showocean = TRUE,\n      oceancolor = \"#B3E5FC\",\n      countrycolor = \"white\",\n      lonaxis = list(range = c(16, 33)), \n      lataxis = list(range = c(-35, -22))\n    )\n  ) %>%\n  config(displayModeBar = FALSE)\n\n\nmap_plot\n```\n---\n\n## 2. Resultados\n\nAquí analizo la trayectoria de la selección. Jugamos 7 partidos en total. Aunque empezamos perdiendo contra Suiza (el punto rojo del gráfico), luego encadenamos 6 victorias seguidas hasta la final. En el gráfico se ve el rival, la fase y el resultado de cada encuentro.\n\n\n```{r}\nlibrary(tidyverse)\n\nruta_a_datos_1 <- \"./datos/resultados.csv\"\ndf_completo <- read_csv(ruta_a_datos_1) \n\nPartidos_España <- df_completo %>% \n  mutate(date = as.Date(date)) %>% \n  filter(tournament == \"FIFA World Cup\",\n         between(date, as.Date(\"2010-06-11\"), as.Date(\"2010-07-11\"))) %>% \n  filter(home_team == \"Spain\" | away_team == \"Spain\") %>%\n  \n  mutate(Resultado_ESP = case_when(\n    (home_team == \"Spain\" & home_score < away_score) ~ \"Perdido\",\n    (away_team == \"Spain\" & away_score < home_score) ~ \"Perdido\",\n    (home_team == \"Spain\" & home_score > away_score) ~ \"Ganado\",\n    (away_team == \"Spain\" & away_score > home_score) ~ \"Ganado\" ))%>% \n  \n  unite(col = \"Resultado\", \n        home_score, away_score, \n        sep = \" - \", \n        remove = FALSE) %>% \n \n  rename(Local = home_team, Visitante = away_team,\n         Torneo = tournament) %>% \n  select(Local, Visitante, Resultado, Resultado_ESP)\n\n\nPartidos_España <- Partidos_España %>%\n  mutate(Orden = 1:n(),\n         Fase = c(\"Grupos 1\", \"Grupos 2\", \"Grupos 3\", \n                  \"Octavos\", \"Cuartos\", \"Semis\", \"Final\"),\n         Rival = ifelse(Local == \"Spain\", Visitante, Local))\n\n\n  ggplot(Partidos_España, aes(x = Orden, y = Resultado_ESP, group = 1)) +\n  geom_path(color = \"gray80\", size = 1) +\n  geom_point(aes(color = Resultado_ESP), size = 12) + \n  geom_text(aes(label = Resultado), color = \"white\", fontface = \"bold\", size = 3) +\n  geom_text(aes(label = paste(\"vs\", Rival)), vjust = -2.5, size = 3.5, fontface =      \"italic\") +\n  geom_text(aes(label = Fase), vjust = 3.5, size = 3, color = \"gray30\") +\n  scale_color_manual(values = c(\"Ganado\" = \"#228B22\", \"Perdido\" = \"#CC0000\")) +\n  scale_y_discrete(limits = c(\"Perdido\", \"Ganado\")) +\n  theme_minimal() +\n  labs(title = \"Cronología: El camino a la estrella\",\n       subtitle = \"Resultados oficiales de cada encuentro\",\n       x = NULL, y = NULL) +\n  theme(\n    panel.grid = element_blank(),\n    axis.text = element_blank(),\n    legend.position = \"none\",\n    plot.title = element_text(face = \"bold\", size = 14))\n```\n---\n\n## 3. Goles\n\nVamos a ver las estadísticas de goles. Lo curioso de este mundial es que España ganó metiendo pocos goles, pero encajando muy pocos también.\n\n### 3.1 Goles metidos\n\nEn ataque, la cosa estuvo muy repartida entre pocos jugadores. He sacado el top 3 de goleadores de la selección: Villa metió la mayoría, pero los goles decisivos de Puyol (semis) e Iniesta (final) aparecen también destacados.\n\n```{r}\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(maps)\nlibrary(plotly)\nlibrary(ggimage)\nlibrary(cropcircles) #install.packages(\"cropcircles\")\nlibrary(magick)    \n\nruta_a_datos_1 <- \"./datos/goalscorers.csv\"\ndf_completo <- read_csv(ruta_a_datos_1)\n\nmundial <- df_completo %>% \nrename(Fecha = date, Equipo_Local = home_team, Equipo_Visitante = away_team\n       , Goleador = scorer) %>% \n  select(Fecha, Equipo_Local, Equipo_Visitante, Goleador) %>% \n  mutate(Fecha = as.Date(Fecha)) %>% \n  filter(between(Fecha, as.Date(\"2010-06-11\") , as.Date(\"2010-07-11\"))) %>% \n  filter(Equipo_Local == \"Spain\"| Equipo_Visitante == \"Spain\") %>% \n  count(Goleador) %>% \n  arrange(desc(n)) %>% \n  head(3)\n\nimagenes_goleadores <- data.frame(\n  Goleador = c(\"David Villa\", \"Andrés Iniesta\", \"Carles Puyol\"),\n  Foto = c(\"villa.jpg\", \"iniesta.png\", \"puyol.jpg\")) %>% \n\n  mutate(logo = file.path(\"imagenes\", Foto))\n\ntop_3 <- left_join(mundial,imagenes_goleadores, by = \"Goleador\") \n\ntop_3 <- top_3 %>%\n  mutate(logo_circular = circle_crop(logo))\n\nmi_grafico <- ggplot(top_3, aes(x = reorder(Goleador, n), y = n)) +\n  geom_col(fill = \"#DD0000\", width = 0.6) +\n  coord_flip() +\n  geom_image(aes(image = logo_circular, y = 0), size = 0.3) +\n  \n  geom_text(aes(label = n), hjust = -0.2, fontface = \"bold\", size = 3.5) +\n  \n  scale_y_continuous(expand = expansion(mult = c(0.2, 0.1))) + \n  \n  labs(\n    title = \"Goleadores de la selección\",\n    subtitle = \"Mundial Sudáfrica 2010\",\n    x = NULL, \n    y = \"Goles\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.y = element_blank(),\n    axis.text.x = element_blank(),\n    axis.ticks = element_blank(),\n    panel.grid.major.y = element_blank(),\n    panel.grid = element_blank(),\n    plot.margin = margin(10, 20, 10, 20))\n\nmi_grafico\n```\n\n### 3.2 Goles encajados\n\nAquí es donde se ganó el mundial. He comparado el promedio de goles encajados por partido de las selecciones que llegaron lejos. Como se ve en el gráfico, la defensa de España fue la mejor, encajando poquísimos goles en comparación con los partidos jugados\n\n\n```{r}\nlibrary(tidyverse)\nlibrary(ggimage)\nlibrary(countrycode)\n\n\nruta_a_datos_1 <- \"./datos/FIFA - 2010.csv\"\ndf_completo <- read_csv(ruta_a_datos_1)\n\n\ntop_10_grafico <- df_completo %>% \n  rename(equipo = Team, \n         partidos_jugados = `Games Played`, \n         goles_contra = `Goals Against`) %>% \n  mutate(equipo = case_when( equipo == \"England\" ~ \"United Kingdom\",\n                            TRUE ~ equipo)) %>%\n  mutate(Goles_partido = goles_contra / partidos_jugados) %>% \n  select(equipo, partidos_jugados, Goles_partido) %>% \n  filter(partidos_jugados >= 4) %>% \n  arrange(Goles_partido) %>% \n  mutate(iso2 = countrycode(equipo, origin = \"country.name\",\n                            destination = \"iso2c\")) %>% \n  mutate(iso2 = tolower(iso2)) %>% \n  mutate(flag_URL = paste0(\"https://hatscripts.github.io/circle-flags/flags/\", iso2, \".svg\"))\n\n\nmi_grafico <- ggplot(top_10_grafico, aes(x = partidos_jugados, y = Goles_partido)) +\n  theme_minimal() +\n  \n  geom_image(aes(image = flag_URL), size = 0.08, position = position_jitter\n             (width = 0.2, height = 0.02, seed = 123)) + \n  \n  \n  labs(\n    title = \"Las mejores defensas\",\n    x = \"Partidos Jugados\",\n    y = \"Goles encajados\") +\n  scale_x_continuous(breaks = 4:7,                \n                     limits = c(3.5, 7.5),         \n                     expand = c(0, 0)) +\n  scale_y_continuous(expand = expansion(mult = c(0.1, 0.1))) +\n  \n  theme(\n    plot.title = element_text(face = \"bold\", size = 16),\n    panel.grid = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.margin = margin(10, 20, 10, 20))\n\n\nmi_grafico\n```\n---\n\n## 4. El gran momento\n\nPara el momento más importante del trabajo he querido hacer algo distinto.He cogido una secuencia de fotos del gol de Iniesta y las he unido todas para crear un GIF. Un gol que sin duda marcó la historia de España.\n\n```{r}\nlibrary(magick)\n\nimg1  <- image_read(\"./imagenes/1.png\") %>% image_scale(\"700\")\nimg2  <- image_read(\"./imagenes/2.png\") %>% image_scale(\"700\")\nimg3  <- image_read(\"./imagenes/3.png\") %>% image_scale(\"700\")\nimg4  <- image_read(\"./imagenes/4.png\") %>% image_scale(\"700\")\nimg5  <- image_read(\"./imagenes/5.png\") %>% image_scale(\"700\")\nimg6  <- image_read(\"./imagenes/6.png\") %>% image_scale(\"700\")\nimg7  <- image_read(\"./imagenes/7.png\") %>% image_scale(\"700\")\nimg8  <- image_read(\"./imagenes/8.png\") %>% image_scale(\"700\")\nimg9  <- image_read(\"./imagenes/9.png\") %>% image_scale(\"700\")\nimg10 <- image_read(\"./imagenes/10.png\") %>% image_scale(\"700\")\nimg11 <- image_read(\"./imagenes/11.png\") %>% image_scale(\"700\")\nimg12 <- image_read(\"./imagenes/12.png\") %>% image_scale(\"700\")\nimg13 <- image_read(\"./imagenes/13.png\") %>% image_scale(\"700\")\nimg14 <- image_read(\"./imagenes/14.png\") %>% image_scale(\"700\")\nimg15 <- image_read(\"./imagenes/15.png\") %>% image_scale(\"700\")\n\nequipos_unidos <- image_join(img1, img2, img3, img4, img5, img6, img7, img8, \n                             img9, img10, img11, img12, img13, img14, img15)\n\nimage_animate(image_scale(equipos_unidos), fps = 1)\n```\n\n---\n\n## 5. Palmarés\n\nFinalmente, así quedó la tabla histórica de campeones del mundo después de nuestra victoria en 2010. He utilizado una tabla un poco más visual con las banderas y los trofeos que tenía cada país hasta ese año.\n\n```{r}\nlibrary(tidyverse)\nlibrary(gt)\nlibrary(gtExtras)   \nlibrary(countrycode) \n\n\nruta_a_datos_1 <- \"./datos/WorldCups.csv\"\ndf_completo <- read_csv(ruta_a_datos_1)\ntabla_preparada <- df_completo %>%\n  filter(Year <= 2010) %>% \n  rename(ganador = Winner) %>%\n  mutate(ganador = case_when( \n    ganador == \"Germany FR\" ~ \"Germany\",\n    ganador == \"England\" ~ \"United Kingdom\",\n    TRUE ~ ganador)) %>% \n  group_by(ganador) %>% \n  summarise(n = n()) %>% \n  arrange(desc(n)) %>% \n  \n  \n  mutate(iso2 = countrycode(ganador, origin = \"country.name\",\n                            destination = \"iso2c\")) %>%\n  mutate(iso2 = tolower(iso2)) %>%\n  mutate(bandera_url = paste0(\"https://hatscripts.github.io/circle-flags/flags/\", iso2, \".svg\")) %>%\n  select(bandera_url, ganador, n)\n\n\n\nmi_tabla_final <- tabla_preparada %>%\n  gt() %>%\n  gt_img_rows(columns = bandera_url, height = 30) %>%\n  cols_label(\n    bandera_url = \"\",\n    ganador = \"Selección\",\n    n = \"Títulos\") %>%\n  tab_header(\n    title = md(\"**Palmarés**\"),\n    subtitle = \"Mundiales ganados hasta 2010\")%>%\n  cols_align(align = \"center\", columns = n) %>%\n  gt_theme_dark() %>%\n  tab_style(\n    style = list(cell_text(weight = \"bold\", color = \"#FFD700\", size = pct(100))),\n    locations = cells_body(columns = n))\n\n\nmi_tabla_final\n```\n\n---\n\n<br>\n\nCon esto acabo mi trabajo para BigData!!\n\n<br>\n\n----------------------\n\n<br>\n\n### Información sobre la sesión\n\nAbajo muestro mi entorno de trabajo y paquetes utilizados\n\n```{r}\n#| echo: false\nsessioninfo::session_info() %>% \n  details::details(summary = 'current session info') \n```\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"png","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"wrap","code-link":true,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","include-in-header":[{"text":"<link rel = \"shortcut icon\" href = \"imagenes/uv.jpeg\" />\n"}],"toc":true,"toc-depth":3,"css":["assets/styles.css"],"highlight-style":"a11y","output-file":"my_trabajo_BigData.html"},"language":{"toc-title-document":"Indice de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilizar","section-title-copyright":"Derechos de autor","section-title-citation":"Cita","appendix-attribution-cite-as":"Por favor cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de Publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Enseñar el código","code-tools-hide-all-code":"Esconder el código","code-tools-view-source":"Ver el código","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiada","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la busqueda","search-hide-matches-text":"Esconder resultados adicionales","search-more-match-text":"hay más resultados en este documento","search-more-matches-text":"más resultados en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Pre-seleccionado","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"Número de mayor a menor","listing-page-order-by-number-asc":"Número de menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de Archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Sub-título","listing-page-field-readingtime":"Tiempo para completar lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.8.24","lightbox":true,"anchor-sections":true,"other-links":[{"text":"Web del curso","href":"https://perezp44.github.io/intro-ds-25-26-web/"},{"text":"Trabajos de mis compañeros","href":"https://perezp44.github.io/intro-ds-25-26-web/05-trabajos-estudiantes.html"},{"text":"Repo del trabajo","href":"https://github.com/Adrifer04/trabajo_BigData_individual"}],"toc-location":"right","toc-title":"Índice","crossref":{"fig-title":"Gráfico","tbl-title":"Tabla"},"fig-cap-location":"bottom","code-copy":true,"knitr":{"opts_chunk":{"collapse":true,"comment":"#>","fig.asp":"7/9","out.width":"95%","fig.align":"center","fig.show":"hold","R.options":"options(scipen = 999)"}},"editor_options":{"chunk_output_type":"console"},"license":"CC BY","page-layout":"full","theme":["flatly"],"mainfont":"Lato","title":"La primera de España","description":"Viendo como la selección española logró este trofeo\n","author":[{"name":"Adrian Fernández","affiliation":"Universitat de València","affiliation-url":"https://www.uv.es"}],"date":"2026-01-07","categories":["trabajo BigData","Futbol","España"],"image":"./imagenes/escudo.png","title-block-banner":true,"title-block-banner-color":"#FFFFFF","smooth-scroll":true,"backgroundcolor":"#DCDCDC"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}